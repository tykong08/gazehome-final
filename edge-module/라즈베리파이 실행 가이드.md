# ë¼ì¦ˆë² ë¦¬íŒŒì´ ì‹¤í–‰ ê°€ì´ë“œ

> **GazeHome Edge-Module ë¼ì¦ˆë² ë¦¬íŒŒì´ ë°°í¬ ê°€ì´ë“œ**  
> 7ì¸ì¹˜ ë””ìŠ¤í”Œë ˆì´ (800x480) ìµœì í™”  
> uv ê¸°ë°˜ Python í™˜ê²½ ê´€ë¦¬

---

## ğŸ“‹ ëª©ì°¨

1. [ì‹œìŠ¤í…œ ìš”êµ¬ì‚¬í•­](#ì‹œìŠ¤í…œ-ìš”êµ¬ì‚¬í•­)
2. [7ì¸ì¹˜ ë””ìŠ¤í”Œë ˆì´ ìµœì í™” í™•ì¸](#7ì¸ì¹˜-ë””ìŠ¤í”Œë ˆì´-ìµœì í™”-í™•ì¸)
3. [í”„ë¡œì íŠ¸ êµ¬ì¡°](#í”„ë¡œì íŠ¸-êµ¬ì¡°)
4. [ì„¤ì¹˜ ë‹¨ê³„](#ì„¤ì¹˜-ë‹¨ê³„)
5. [ì„œë¹„ìŠ¤ ë“±ë¡](#ì„œë¹„ìŠ¤-ë“±ë¡)
6. [ë¬¸ì œ í•´ê²°](#ë¬¸ì œ-í•´ê²°)
7. [ì „ì²´ ëª…ë ¹ì–´ ìš”ì•½](#ì „ì²´-ëª…ë ¹ì–´-ìš”ì•½)

---

## ì‹œìŠ¤í…œ ìš”êµ¬ì‚¬í•­

### í•˜ë“œì›¨ì–´
- **ë¼ì¦ˆë² ë¦¬íŒŒì´ 4** (ê¶Œì¥) ë˜ëŠ” ë¼ì¦ˆë² ë¦¬íŒŒì´ 3B+
- **7ì¸ì¹˜ í„°ì¹˜ ë””ìŠ¤í”Œë ˆì´** (800x480 í•´ìƒë„)
- **ì›¹ìº ** (ì‹œì„  ì¶”ì ìš©)
- **ìµœì†Œ 4GB RAM** (8GB ê¶Œì¥)
- **ìµœì†Œ 16GB microSD** (32GB ê¶Œì¥)

### ì†Œí”„íŠ¸ì›¨ì–´
- Raspberry Pi OS (64-bit, Bullseye ì´ìƒ)
- Python 3.9 ì´ìƒ
- Node.js 20.x
- ì¸í„°ë„· ì—°ê²°

### ì™¸ë¶€ ì„œë¹„ìŠ¤
- **AI-Services**: `http://34.227.8.172:8000` (ì´ë¯¸ ì‹¤í–‰ ì¤‘)
- **LG ThinQ API í† í°** (Gatewayìš©)

---

## 7ì¸ì¹˜ ë””ìŠ¤í”Œë ˆì´ ìµœì í™” í™•ì¸

Edge-Module FrontendëŠ” 7ì¸ì¹˜ ë””ìŠ¤í”Œë ˆì´ì— ìµœì í™”ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

| í•­ëª©               | ê°’                | ìƒíƒœ |
| ------------------ | ----------------- | ---- |
| **í•´ìƒë„**         | 800x480px         | âœ…    |
| **ë ˆì´ì•„ì›ƒ**       | 2ì—´ ê·¸ë¦¬ë“œ        | âœ…    |
| **ê¸°ê¸° ì¹´ë“œ íŒ¨ë”©** | 8px               | âœ…    |
| **ê¸°ê¸° ì•„ì´ì½˜**    | 32x32px           | âœ…    |
| **ì•¡ì…˜ ë²„íŠ¼ í¬ê¸°** | 40px (min-height) | âœ…    |
| **ë²„íŠ¼ í°íŠ¸**      | 0.7rem            | âœ…    |
| **ì˜¨ë„ ë²„íŠ¼**      | 40x40px           | âœ…    |
| **ê·¸ë¦¬ë“œ ê°­**      | 12px              | âœ…    |
| **í˜ì´ì§€ ìŠ¤í¬ë¡¤**  | ì—†ìŒ              | âœ…    |
| **ì´ ë²ˆë“¤ í¬ê¸°**   | 348KB             | âœ…    |

### UI ìµœì í™” íŠ¹ì§•
- âœ… ì‹œì„  ì¶”ì ì— ìµœì í™”ëœ í° ë²„íŠ¼ (40px)
- âœ… 2ê°œ ê³ ì • ê¸°ê¸°ë§Œ í‘œì‹œ (ìŠ¤í¬ë¡¤ ë¶ˆí•„ìš”)
- âœ… ì»´íŒ©íŠ¸í•œ ë””ìì¸ (7ì¸ì¹˜ í™”ë©´ì— ëª¨ë‘ í‘œì‹œ)
- âœ… ë¼ì¦ˆë² ë¦¬íŒŒì´ ì„±ëŠ¥ ìµœì í™” (Terser minification)

---

## í”„ë¡œì íŠ¸ êµ¬ì¡°

```
~/gazehome/
â”œâ”€â”€ edge-module/               # Main í”„ë¡œì íŠ¸
â”‚   â”œâ”€â”€ pyproject.toml        # Python ì˜ì¡´ì„± (uv ì‚¬ìš©)
â”‚   â”œâ”€â”€ backend/              # FastAPI ë°±ì—”ë“œ
â”‚   â”‚   â”œâ”€â”€ run.py
â”‚   â”‚   â”œâ”€â”€ .env             # í™˜ê²½ ë³€ìˆ˜ (ìƒì„± í•„ìš”)
â”‚   â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”œâ”€â”€ core/
â”‚   â”‚   â””â”€â”€ services/
â”‚   â”œâ”€â”€ frontend/             # React í”„ë¡ íŠ¸ì—”ë“œ
â”‚   â”‚   â”œâ”€â”€ package.json
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â””â”€â”€ dist/            # ë¹Œë“œ ê²°ê³¼ë¬¼
â”‚   â””â”€â”€ model/                # ì‹œì„  ì¶”ì  ëª¨ë¸
â”‚
â””â”€â”€ gateway/                   # LG ThinQ Gateway
    â”œâ”€â”€ main.py
    â”œâ”€â”€ lg_client.py
    â””â”€â”€ .env                  # í™˜ê²½ ë³€ìˆ˜ (ìƒì„± í•„ìš”)
```

---

## ì„¤ì¹˜ ë‹¨ê³„

### Step 1: ì‹œìŠ¤í…œ íŒ¨í‚¤ì§€ ì„¤ì¹˜

```bash
# ì‹œìŠ¤í…œ ì—…ë°ì´íŠ¸
sudo apt update && sudo apt upgrade -y

# í•„ìˆ˜ ê°œë°œ ë„êµ¬
sudo apt install -y \
    git \
    curl \
    build-essential \
    libssl-dev \
    libffi-dev \
    python3-dev

# OpenCV ë° ì´ë¯¸ì§€ ì²˜ë¦¬ ë¼ì´ë¸ŒëŸ¬ë¦¬
sudo apt install -y \
    python3-opencv \
    libopencv-dev \
    libatlas-base-dev

# ë°ì´í„°ë² ì´ìŠ¤
sudo apt install -y \
    sqlite3 \
    libsqlite3-dev

# Node.js 20.x ì„¤ì¹˜ (í”„ë¡ íŠ¸ì—”ë“œìš©)
curl -fsSL https://deb.nodesource.com/setup_20.x | sudo -E bash -
sudo apt install -y nodejs

# ì„¤ì¹˜ í™•ì¸
node --version  # v20.x.x
npm --version   # 10.x.x
```

### Step 2: uv ì„¤ì¹˜

```bash
# uv ì„¤ì¹˜ (Python íŒ¨í‚¤ì§€ ë§¤ë‹ˆì €)
curl -LsSf https://astral.sh/uv/install.sh | sh

# PATH ì¶”ê°€ (í˜„ì¬ ì„¸ì…˜)
source $HOME/.cargo/env

# ì˜êµ¬ì ìœ¼ë¡œ PATH ì¶”ê°€
echo 'source $HOME/.cargo/env' >> ~/.bashrc

# ì„¤ì¹˜ í™•ì¸
uv --version  # uv 0.x.x
```

---

### Step 3: í”„ë¡œì íŠ¸ í´ë¡ 

```bash
# ì‘ì—… ë””ë ‰í† ë¦¬ ìƒì„±
mkdir -p ~/gazehome
cd ~/gazehome

# Edge-Module í´ë¡  (develop ë¸Œëœì¹˜)
git clone https://github.com/ESWC-AIRIS/edge-module.git
cd edge-module
git checkout develop

# ìµœì‹  ì»¤ë°‹ í™•ì¸
git log --oneline -3
# a7de2ec feat: Optimize device control and calibration...
# f5dc453 chore: Clean up unused files...
# 6cbbca8 feat: Implement device actions...

# Gateway í´ë¡  (ë³„ë„ ë””ë ‰í† ë¦¬)
cd ~/gazehome
git clone https://github.com/ESWC-AIRIS/gateway.git
cd gateway
git checkout main

# ë””ë ‰í† ë¦¬ êµ¬ì¡° í™•ì¸
cd ~/gazehome
tree -L 2
```

---

### Step 4: Edge-Module Backend ì„¤ì •

```bash
cd ~/gazehome/edge-module

# pyproject.tomlì„ ì‚¬ìš©í•˜ì—¬ ì˜ì¡´ì„± ì„¤ì¹˜
uv sync

# ë˜ëŠ” íŠ¹ì • Python ë²„ì „ ì§€ì •
uv sync --python 3.11

# í™˜ê²½ ë³€ìˆ˜ íŒŒì¼ ìƒì„±
cat > backend/.env << 'EOF'
# AI-Services URL (ì™¸ë¶€ ì„œë²„ - ì´ë¯¸ ì‹¤í–‰ ì¤‘)
AI_SERVER_URL=http://34.227.8.172:8000
AI_REQUEST_TIMEOUT=60
AI_MAX_RETRIES=3

# Gateway URL (ë¡œì»¬)
GATEWAY_URL=http://localhost:9000

# Database ê²½ë¡œ
DATABASE_PATH=/home/pi/.gazehome/calibrations/gazehome.db

# Calibration ì €ì¥ ê²½ë¡œ
CALIBRATION_DIR=/home/pi/.gazehome/calibrations

# Server ì„¤ì •
HOST=0.0.0.0
PORT=8080
EOF

# í•„ìˆ˜ ë””ë ‰í† ë¦¬ ìƒì„±
mkdir -p ~/.gazehome/calibrations

# ì„¤ì¹˜ í™•ì¸
uv run python --version
uv run python -c "import fastapi; print('âœ… FastAPI installed')"
uv run python -c "import cv2; print('âœ… OpenCV installed')"
uv run python -c "import mediapipe; print('âœ… MediaPipe installed')"
```

**pyproject.tomlì— ì •ì˜ëœ ì£¼ìš” ì˜ì¡´ì„±:**
- `opencv-python>=4.5` - ì‹œì„  ì¶”ì 
- `mediapipe>=0.10` - ì–¼êµ´/ëˆˆ ê°ì§€
- `fastapi>=0.104.0` - API ì„œë²„
- `uvicorn[standard]>=0.24.0` - ASGI ì„œë²„
- `websockets>=12.0` - ì‹¤ì‹œê°„ í†µì‹ 
- `scikit-learn>=1.3` - ì‹œì„  ëª¨ë¸

---

### Step 5: Frontend ì„¤ì •

```bash
cd ~/gazehome/edge-module/frontend

# npm ì˜ì¡´ì„± ì„¤ì¹˜
npm install

# í”„ë¡œë•ì…˜ ë¹Œë“œ
npm run build

# ë¹Œë“œ ê²°ê³¼ í™•ì¸
ls -lh dist/
# total 348K
# drwxr-xr-x 3 pi pi   96 Oct 29 00:00 assets
# -rw-r--r-- 1 pi pi 1.2K Oct 29 00:00 index.html
# drwxr-xr-x 7 pi pi  224 Oct 29 00:00 js

du -sh dist/
# 348K dist/
```

**Frontend ì˜ì¡´ì„± (package.json):**
- `react@18.2.0` - UI í”„ë ˆì„ì›Œí¬
- `react-router-dom@6.20.0` - ë¼ìš°íŒ…
- `framer-motion@10.16.16` - ì• ë‹ˆë©”ì´ì…˜
- `lucide-react@0.294.0` - ì•„ì´ì½˜
- `vite@6.1.7` - ë¹Œë“œ ë„êµ¬
- `terser@5.44.0` - ì½”ë“œ ì••ì¶•

---

### Step 6: Gateway ì„¤ì •

```bash
cd ~/gazehome/gateway

# GatewayëŠ” ë³„ë„ pyproject.tomlì´ ì—†ìœ¼ë¯€ë¡œ ìˆ˜ë™ ì„¤ì¹˜
uv init --no-workspace

# í•„ìš”í•œ íŒ¨í‚¤ì§€ ì„¤ì¹˜
uv pip install fastapi uvicorn[standard] httpx python-dotenv wideq

# í™˜ê²½ ë³€ìˆ˜ íŒŒì¼ ìƒì„±
cat > .env << 'EOF'
# LG ThinQ API í† í°
LG_PAT_TOKEN=YOUR_LG_TOKEN_HERE

# ì„œë²„ ì„¤ì •
HOST=0.0.0.0
PORT=9000

# Debug ëª¨ë“œ
DEBUG_MODE=true
EOF

# âš ï¸ LG ThinQ í† í° ì…ë ¥ í•„ìš”!
nano .env
# YOUR_LG_TOKEN_HEREë¥¼ ì‹¤ì œ í† í°ìœ¼ë¡œ êµì²´
```

**LG ThinQ í† í° ë°œê¸‰ ë°©ë²•:**
1. https://kr.lgaccount.com/ ì—ì„œ ë¡œê·¸ì¸
2. API í† í° ë°œê¸‰ (ThinQ ê°œë°œì í˜ì´ì§€)
3. `.env` íŒŒì¼ì˜ `LG_PAT_TOKEN`ì— ì…ë ¥

---

### Step 7: ì‹¤í–‰ í…ŒìŠ¤íŠ¸

#### Terminal 1: Gateway ì‹¤í–‰

```bash
cd ~/gazehome/gateway
uv run python main.py

# ì‹¤í–‰ í™•ì¸
# INFO:     Started server process [12345]
# INFO:     Waiting for application startup.
# INFO:     Application startup complete.
# INFO:     Uvicorn running on http://0.0.0.0:9000 (Press CTRL+C to quit)
```

#### Terminal 2: Backend ì‹¤í–‰

```bash
cd ~/gazehome/edge-module

# ë°©ë²• 1: ì§ì ‘ ì‹¤í–‰
uv run python backend/run.py

# ë°©ë²• 2: pyproject.toml ìŠ¤í¬ë¦½íŠ¸ ì‚¬ìš©
uv run gazehome-backend

# ì‹¤í–‰ í™•ì¸
# INFO:     Started server process [12346]
# INFO:     Waiting for application startup.
# INFO:     Application startup complete.
# INFO:     Uvicorn running on http://0.0.0.0:8080 (Press CTRL+C to quit)
```

#### Terminal 3: Frontend ê°œë°œ ì„œë²„ (ì„ íƒì‚¬í•­)

```bash
cd ~/gazehome/edge-module/frontend
npm run dev

# ì‹¤í–‰ í™•ì¸
# VITE v6.4.0 ready in 1234 ms
# âœ  Local:   http://localhost:3000/
# âœ  Network: http://192.168.x.x:3000/
```

#### í…ŒìŠ¤íŠ¸

```bash
# Gateway í…ŒìŠ¤íŠ¸
curl http://localhost:9000/health
# {"status":"healthy"}

# Backend í…ŒìŠ¤íŠ¸
curl http://localhost:8080/health
# {"status":"healthy"}

# Frontend í…ŒìŠ¤íŠ¸ (ë¸Œë¼ìš°ì €)
# http://<ë¼ì¦ˆë² ë¦¬íŒŒì´_IP>:3000
```

---

## ì„œë¹„ìŠ¤ ë“±ë¡

ë¼ì¦ˆë² ë¦¬íŒŒì´ ë¶€íŒ… ì‹œ ìë™ìœ¼ë¡œ ì„œë¹„ìŠ¤ë¥¼ ì‹œì‘í•˜ë„ë¡ systemd ì„œë¹„ìŠ¤ë¥¼ ë“±ë¡í•©ë‹ˆë‹¤.

### Step 1: Gateway ì„œë¹„ìŠ¤ ë“±ë¡

```bash
sudo nano /etc/systemd/system/gazehome-gateway.service
```

**íŒŒì¼ ë‚´ìš©:**

```ini
[Unit]
Description=GazeHome Gateway Service
After=network.target

[Service]
Type=simple
User=pi
WorkingDirectory=/home/pi/gazehome/gateway
Environment="PATH=/home/pi/.cargo/bin:/usr/local/bin:/usr/bin:/bin"
ExecStart=/home/pi/.cargo/bin/uv run python main.py
Restart=always
RestartSec=10

[Install]
WantedBy=multi-user.target
```

---

### Step 2: Backend ì„œë¹„ìŠ¤ ë“±ë¡

```bash
sudo nano /etc/systemd/system/gazehome-backend.service
```

**íŒŒì¼ ë‚´ìš©:**

```ini
[Unit]
Description=GazeHome Backend Service
After=network.target gazehome-gateway.service

[Service]
Type=simple
User=pi
WorkingDirectory=/home/pi/gazehome/edge-module
Environment="PATH=/home/pi/.cargo/bin:/usr/local/bin:/usr/bin:/bin"
ExecStart=/home/pi/.cargo/bin/uv run gazehome-backend
Restart=always
RestartSec=10

[Install]
WantedBy=multi-user.target
```

---

### Step 3: ì„œë¹„ìŠ¤ í™œì„±í™” ë° ì‹œì‘

```bash
# systemd ë°ëª¬ ë¦¬ë¡œë“œ
sudo systemctl daemon-reload

# ì„œë¹„ìŠ¤ í™œì„±í™” (ë¶€íŒ… ì‹œ ìë™ ì‹œì‘)
sudo systemctl enable gazehome-gateway
sudo systemctl enable gazehome-backend

# ì„œë¹„ìŠ¤ ì‹œì‘
sudo systemctl start gazehome-gateway
sudo systemctl start gazehome-backend

# ìƒíƒœ í™•ì¸
sudo systemctl status gazehome-gateway
sudo systemctl status gazehome-backend
```

**ì˜ˆìƒ ì¶œë ¥:**

```
â— gazehome-gateway.service - GazeHome Gateway Service
     Loaded: loaded (/etc/systemd/system/gazehome-gateway.service; enabled)
     Active: active (running) since Wed 2025-01-29 12:00:00 KST
   Main PID: 1234 (python)
      Tasks: 4 (limit: 4915)
     Memory: 45.2M
        CPU: 2.345s
     CGroup: /system.slice/gazehome-gateway.service
             â””â”€1234 python main.py
```

---

### Step 4: ë¡œê·¸ í™•ì¸

```bash
# Gateway ì‹¤ì‹œê°„ ë¡œê·¸
sudo journalctl -u gazehome-gateway -f

# Backend ì‹¤ì‹œê°„ ë¡œê·¸
sudo journalctl -u gazehome-backend -f

# ìµœê·¼ 50ì¤„ ë¡œê·¸
sudo journalctl -u gazehome-backend -n 50

# íŠ¹ì • ì‹œê°„ëŒ€ ë¡œê·¸
sudo journalctl -u gazehome-backend --since "2025-01-29 12:00:00"
```

---

### Step 5: ì„œë¹„ìŠ¤ ì œì–´ ëª…ë ¹ì–´

```bash
# ì„œë¹„ìŠ¤ ì‹œì‘
sudo systemctl start gazehome-gateway
sudo systemctl start gazehome-backend

# ì„œë¹„ìŠ¤ ì¤‘ì§€
sudo systemctl stop gazehome-gateway
sudo systemctl stop gazehome-backend

# ì„œë¹„ìŠ¤ ì¬ì‹œì‘
sudo systemctl restart gazehome-gateway
sudo systemctl restart gazehome-backend

# ì„œë¹„ìŠ¤ ìƒíƒœ í™•ì¸
sudo systemctl status gazehome-gateway
sudo systemctl status gazehome-backend

# ë¶€íŒ… ì‹œ ìë™ ì‹œì‘ í™œì„±í™”
sudo systemctl enable gazehome-gateway

# ë¶€íŒ… ì‹œ ìë™ ì‹œì‘ ë¹„í™œì„±í™”
sudo systemctl disable gazehome-gateway
```

---

## Nginx ë°°í¬ (í”„ë¡œë•ì…˜)

ê°œë°œ ì„œë²„(`npm run dev`) ëŒ€ì‹  Nginxë¥¼ ì‚¬ìš©í•˜ì—¬ í”„ë¡ íŠ¸ì—”ë“œë¥¼ ë°°í¬í•©ë‹ˆë‹¤.

### Step 1: Nginx ì„¤ì¹˜

```bash
sudo apt install -y nginx

# ì„¤ì¹˜ í™•ì¸
nginx -v
# nginx version: nginx/1.18.0
```

---

### Step 2: ë¹Œë“œëœ íŒŒì¼ ë°°í¬

```bash
# ê¸°ì¡´ íŒŒì¼ ì‚­ì œ
sudo rm -rf /var/www/html/*

# ë¹Œë“œëœ íŒŒì¼ ë³µì‚¬
sudo cp -r ~/gazehome/edge-module/frontend/dist/* /var/www/html/

# ê¶Œí•œ ì„¤ì •
sudo chown -R www-data:www-data /var/www/html
sudo chmod -R 755 /var/www/html

# íŒŒì¼ í™•ì¸
ls -la /var/www/html/
```

---

### Step 3: Nginx ì„¤ì •

```bash
sudo nano /etc/nginx/sites-available/default
```

**íŒŒì¼ ë‚´ìš©:**

```nginx
server {
    listen 80 default_server;
    listen [::]:80 default_server;
    
    root /var/www/html;
    index index.html;
    
    server_name _;
    
    # React Router ì§€ì› (SPA - Single Page Application)
    location / {
        try_files $uri $uri/ /index.html;
    }
    
    # Backend API í”„ë¡ì‹œ
    location /api/ {
        proxy_pass http://localhost:8080/api/;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
        
        # íƒ€ì„ì•„ì›ƒ ì„¤ì • (ì‹œì„  ë³´ì • ë“± ê¸´ ì‘ì—…)
        proxy_read_timeout 300s;
        proxy_connect_timeout 75s;
    }
    
    # WebSocket í”„ë¡ì‹œ (ì‹œì„  ì¶”ì  ì‹¤ì‹œê°„ ë°ì´í„°)
    location /ws {
        proxy_pass http://localhost:8080/ws;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "Upgrade";
        proxy_set_header Host $host;
        
        # WebSocket íƒ€ì„ì•„ì›ƒ (24ì‹œê°„)
        proxy_read_timeout 86400;
    }
    
    # ìºì‹± ì„¤ì • (ì •ì  íŒŒì¼)
    location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg)$ {
        expires 1y;
        add_header Cache-Control "public, immutable";
    }
}
```

---

### Step 4: Nginx í…ŒìŠ¤íŠ¸ ë° ì¬ì‹œì‘

```bash
# ì„¤ì • íŒŒì¼ ë¬¸ë²• ê²€ì‚¬
sudo nginx -t

# ì˜ˆìƒ ì¶œë ¥:
# nginx: the configuration file /etc/nginx/nginx.conf syntax is ok
# nginx: configuration file /etc/nginx/nginx.conf test is successful

# Nginx ì¬ì‹œì‘
sudo systemctl restart nginx

# Nginx ë¶€íŒ… ì‹œ ìë™ ì‹œì‘
sudo systemctl enable nginx

# ìƒíƒœ í™•ì¸
sudo systemctl status nginx
```

---

### Step 5: ì ‘ì† í™•ì¸

```bash
# ë¼ì¦ˆë² ë¦¬íŒŒì´ IP í™•ì¸
hostname -I
# 192.168.x.x

# ë¸Œë¼ìš°ì €ì—ì„œ ì ‘ì†
# http://192.168.x.x

# ë˜ëŠ” mDNS ì‚¬ìš© (ë™ì¼ ë„¤íŠ¸ì›Œí¬)
# http://raspberrypi.local
```

---

## ë¬¸ì œ í•´ê²°

### 1. uv ëª…ë ¹ì–´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ

**ì¦ìƒ:**
```bash
uv: command not found
```

**í•´ê²°:**
```bash
# PATH ì¶”ê°€
source $HOME/.cargo/env

# ì˜êµ¬ ì ìš©
echo 'source $HOME/.cargo/env' >> ~/.bashrc
source ~/.bashrc
```

---

### 2. OpenCV import ì˜¤ë¥˜

**ì¦ìƒ:**
```
ImportError: libGL.so.1: cannot open shared object file
```

**í•´ê²°:**
```bash
sudo apt install -y libgl1-mesa-glx libglib2.0-0
```

---

### 3. MediaPipe import ì˜¤ë¥˜

**ì¦ìƒ:**
```
ModuleNotFoundError: No module named 'mediapipe'
```

**í•´ê²°:**
```bash
cd ~/gazehome/edge-module
uv sync --reinstall
```

---

### 4. Gateway ì—°ê²° ì‹¤íŒ¨

**ì¦ìƒ:**
```
ERROR: Failed to connect to Gateway: http://localhost:9000
```

**í•´ê²°:**
```bash
# Gateway ì„œë¹„ìŠ¤ ìƒíƒœ í™•ì¸
sudo systemctl status gazehome-gateway

# Gateway ë¡œê·¸ í™•ì¸
sudo journalctl -u gazehome-gateway -n 50

# Gateway ì¬ì‹œì‘
sudo systemctl restart gazehome-gateway
```

---

### 5. AI-Services ì—°ê²° ì‹¤íŒ¨

**ì¦ìƒ:**
```
ERROR: Failed to connect to AI-Services: http://34.227.8.172:8000
```

**í•´ê²°:**
```bash
# ë„¤íŠ¸ì›Œí¬ ì—°ê²° í™•ì¸
ping 34.227.8.172

# AI-Services ìƒíƒœ í™•ì¸
curl http://34.227.8.172:8000/health

# backend/.env íŒŒì¼ í™•ì¸
cat ~/gazehome/edge-module/backend/.env | grep AI_SERVER_URL
```

---

### 6. í¬íŠ¸ ì¶©ëŒ

**ì¦ìƒ:**
```
ERROR: [Errno 98] Address already in use
```

**í•´ê²°:**
```bash
# í¬íŠ¸ ì‚¬ìš© ì¤‘ì¸ í”„ë¡œì„¸ìŠ¤ í™•ì¸
sudo lsof -i :8080
sudo lsof -i :9000

# í”„ë¡œì„¸ìŠ¤ ì¢…ë£Œ
sudo kill -9 <PID>

# ì„œë¹„ìŠ¤ ì¬ì‹œì‘
sudo systemctl restart gazehome-backend
sudo systemctl restart gazehome-gateway
```

---

### 7. í”„ë¡ íŠ¸ì—”ë“œ ë¹Œë“œ ì‹¤íŒ¨

**ì¦ìƒ:**
```
npm ERR! terser not found
```

**í•´ê²°:**
```bash
cd ~/gazehome/edge-module/frontend
npm install terser --save-dev
npm run build
```

---

### 8. Nginx 404 ì—ëŸ¬

**ì¦ìƒ:**
- ë¸Œë¼ìš°ì €ì—ì„œ `404 Not Found` í‘œì‹œ
- `/api/` ê²½ë¡œë§Œ ì‘ë™

**í•´ê²°:**
```bash
# íŒŒì¼ ì¡´ì¬ í™•ì¸
ls -la /var/www/html/

# íŒŒì¼ ì¬ë°°í¬
sudo cp -r ~/gazehome/edge-module/frontend/dist/* /var/www/html/

# Nginx ì¬ì‹œì‘
sudo systemctl restart nginx
```

---

### 9. WebSocket ì—°ê²° ì‹¤íŒ¨

**ì¦ìƒ:**
```
WebSocket connection to 'ws://...' failed
```

**í•´ê²°:**
```bash
# Backend WebSocket ì—”ë“œí¬ì¸íŠ¸ í™•ì¸
curl http://localhost:8080/ws/features

# Nginx ì„¤ì • í™•ì¸
sudo nano /etc/nginx/sites-available/default
# location /ws ì„¹ì…˜ í™•ì¸

# Nginx ì¬ì‹œì‘
sudo systemctl restart nginx
```

---

### 10. ë³´ì • ë°ì´í„° ì €ì¥ ì‹¤íŒ¨

**ì¦ìƒ:**
```
ERROR: Permission denied: /home/pi/.gazehome/calibrations/
```

**í•´ê²°:**
```bash
# ë””ë ‰í† ë¦¬ ê¶Œí•œ í™•ì¸
ls -la ~/.gazehome/

# ë””ë ‰í† ë¦¬ ì¬ìƒì„±
mkdir -p ~/.gazehome/calibrations
chmod 755 ~/.gazehome/calibrations

# Backend ì¬ì‹œì‘
sudo systemctl restart gazehome-backend
```

---

## ì „ì²´ ëª…ë ¹ì–´ ìš”ì•½

**ë³µì‚¬í•´ì„œ í•œ ë²ˆì— ì‹¤í–‰ ê°€ëŠ¥í•œ ìŠ¤í¬ë¦½íŠ¸**

```bash
#!/bin/bash
# GazeHome ë¼ì¦ˆë² ë¦¬íŒŒì´ ìë™ ì„¤ì¹˜ ìŠ¤í¬ë¦½íŠ¸

set -e  # ì˜¤ë¥˜ ë°œìƒ ì‹œ ì¤‘ë‹¨

echo "==================================================================="
echo "GazeHome ë¼ì¦ˆë² ë¦¬íŒŒì´ ì„¤ì¹˜ ì‹œì‘"
echo "==================================================================="

# 1. ì‹œìŠ¤í…œ íŒ¨í‚¤ì§€ ì„¤ì¹˜
echo "[1/8] ì‹œìŠ¤í…œ íŒ¨í‚¤ì§€ ì„¤ì¹˜..."
sudo apt update && sudo apt upgrade -y
sudo apt install -y git curl build-essential python3-dev python3-opencv sqlite3 libssl-dev libffi-dev libopencv-dev libatlas-base-dev libsqlite3-dev

# Node.js ì„¤ì¹˜
echo "[2/8] Node.js ì„¤ì¹˜..."
curl -fsSL https://deb.nodesource.com/setup_20.x | sudo -E bash -
sudo apt install -y nodejs

# uv ì„¤ì¹˜
echo "[3/8] uv ì„¤ì¹˜..."
curl -LsSf https://astral.sh/uv/install.sh | sh
source $HOME/.cargo/env
echo 'source $HOME/.cargo/env' >> ~/.bashrc

# í”„ë¡œì íŠ¸ í´ë¡ 
echo "[4/8] í”„ë¡œì íŠ¸ í´ë¡ ..."
mkdir -p ~/gazehome && cd ~/gazehome
git clone https://github.com/ESWC-AIRIS/edge-module.git
cd edge-module && git checkout develop
cd ~/gazehome
git clone https://github.com/ESWC-AIRIS/gateway.git
cd gateway && git checkout main

# Backend ì„¤ì •
echo "[5/8] Backend ì„¤ì •..."
cd ~/gazehome/edge-module
uv sync
mkdir -p ~/.gazehome/calibrations

cat > backend/.env << 'EOF'
AI_SERVER_URL=http://34.227.8.172:8000
AI_REQUEST_TIMEOUT=60
AI_MAX_RETRIES=3
GATEWAY_URL=http://localhost:9000
DATABASE_PATH=/home/pi/.gazehome/calibrations/gazehome.db
CALIBRATION_DIR=/home/pi/.gazehome/calibrations
HOST=0.0.0.0
PORT=8080
EOF

# Frontend ë¹Œë“œ
echo "[6/8] Frontend ë¹Œë“œ..."
cd ~/gazehome/edge-module/frontend
npm install
npm run build

# Gateway ì„¤ì •
echo "[7/8] Gateway ì„¤ì •..."
cd ~/gazehome/gateway
uv init --no-workspace
uv pip install fastapi uvicorn[standard] httpx python-dotenv wideq

cat > .env << 'EOF'
LG_PAT_TOKEN=YOUR_LG_TOKEN_HERE
HOST=0.0.0.0
PORT=9000
DEBUG_MODE=true
EOF

echo ""
echo "âš ï¸  LG ThinQ í† í°ì„ ì…ë ¥í•˜ì„¸ìš”:"
echo "nano ~/gazehome/gateway/.env"
echo ""

# Nginx ì„¤ì¹˜
echo "[8/8] Nginx ì„¤ì¹˜ ë° ë°°í¬..."
sudo apt install -y nginx
sudo rm -rf /var/www/html/*
sudo cp -r ~/gazehome/edge-module/frontend/dist/* /var/www/html/
sudo chown -R www-data:www-data /var/www/html

echo ""
echo "==================================================================="
echo "âœ… ì„¤ì¹˜ ì™„ë£Œ!"
echo "==================================================================="
echo ""
echo "ë‹¤ìŒ ë‹¨ê³„:"
echo "1. LG ThinQ í† í° ì…ë ¥: nano ~/gazehome/gateway/.env"
echo "2. systemd ì„œë¹„ìŠ¤ ë“±ë¡ (ê°€ì´ë“œ ì°¸ì¡°)"
echo "3. Nginx ì„¤ì • (ê°€ì´ë“œ ì°¸ì¡°)"
echo "4. ë¸Œë¼ìš°ì € ì ‘ì†: http://$(hostname -I | awk '{print $1}')"
echo ""
```

**ìŠ¤í¬ë¦½íŠ¸ ì‚¬ìš©ë²•:**

```bash
# íŒŒì¼ë¡œ ì €ì¥
nano ~/install_gazehome.sh

# ìœ„ ìŠ¤í¬ë¦½íŠ¸ ë‚´ìš© ë¶™ì—¬ë„£ê¸°

# ì‹¤í–‰ ê¶Œí•œ ë¶€ì—¬
chmod +x ~/install_gazehome.sh

# ì‹¤í–‰
./install_gazehome.sh
```

---

## ì²´í¬ë¦¬ìŠ¤íŠ¸

ì„¤ì¹˜ê°€ ì™„ë£Œë˜ë©´ ì•„ë˜ í•­ëª©ì„ í™•ì¸í•˜ì„¸ìš”.

- [ ] **ì‹œìŠ¤í…œ íŒ¨í‚¤ì§€ ì„¤ì¹˜ ì™„ë£Œ**
  - [ ] Python 3.9+ ì„¤ì¹˜ë¨
  - [ ] Node.js 20.x ì„¤ì¹˜ë¨
  - [ ] uv ì„¤ì¹˜ë¨
  - [ ] OpenCV, SQLite ì„¤ì¹˜ë¨

- [ ] **í”„ë¡œì íŠ¸ í´ë¡  ì™„ë£Œ**
  - [ ] Edge-Module (develop ë¸Œëœì¹˜)
  - [ ] Gateway (main ë¸Œëœì¹˜)

- [ ] **Backend ì„¤ì • ì™„ë£Œ**
  - [ ] `uv sync` ì™„ë£Œ
  - [ ] `backend/.env` íŒŒì¼ ìƒì„±
  - [ ] `~/.gazehome/calibrations/` ë””ë ‰í† ë¦¬ ìƒì„±

- [ ] **Frontend ë¹Œë“œ ì™„ë£Œ**
  - [ ] `npm install` ì™„ë£Œ
  - [ ] `npm run build` ì™„ë£Œ
  - [ ] `dist/` ë””ë ‰í† ë¦¬ ìƒì„± (348KB)

- [ ] **Gateway ì„¤ì • ì™„ë£Œ**
  - [ ] íŒ¨í‚¤ì§€ ì„¤ì¹˜ ì™„ë£Œ
  - [ ] `.env` íŒŒì¼ ìƒì„±
  - [ ] **LG ThinQ í† í° ì…ë ¥ ì™„ë£Œ** âš ï¸

- [ ] **ì„œë¹„ìŠ¤ ë“±ë¡ ì™„ë£Œ**
  - [ ] `gazehome-gateway.service` ë“±ë¡
  - [ ] `gazehome-backend.service` ë“±ë¡
  - [ ] ì„œë¹„ìŠ¤ ì‹¤í–‰ í™•ì¸

- [ ] **Nginx ë°°í¬ ì™„ë£Œ**
  - [ ] Nginx ì„¤ì¹˜
  - [ ] ì •ì  íŒŒì¼ ë°°í¬
  - [ ] Nginx ì„¤ì • íŒŒì¼ ìˆ˜ì •
  - [ ] Nginx ì¬ì‹œì‘

- [ ] **ì ‘ì† í™•ì¸**
  - [ ] `http://<ë¼ì¦ˆë² ë¦¬íŒŒì´_IP>` ì ‘ì† ê°€ëŠ¥
  - [ ] ë¡œê·¸ì¸ í™”ë©´ í‘œì‹œ
  - [ ] ì‹œì„  ë³´ì • í™”ë©´ ì§„ì… ê°€ëŠ¥

---

## ì¶”ê°€ ì •ë³´

### í¬íŠ¸ ì‚¬ìš© í˜„í™©

| ì„œë¹„ìŠ¤              | í¬íŠ¸ | ìš©ë„             |
| ------------------- | ---- | ---------------- |
| Frontend (ê°œë°œ)     | 3000 | Vite ê°œë°œ ì„œë²„   |
| Frontend (í”„ë¡œë•ì…˜) | 80   | Nginx            |
| Backend             | 8080 | FastAPI API ì„œë²„ |
| Gateway             | 9000 | LG ThinQ Gateway |
| AI-Services         | 8000 | ì™¸ë¶€ ì„œë²„ (EC2)  |

### ì£¼ìš” ê²½ë¡œ

| í•­ëª©          | ê²½ë¡œ                                    |
| ------------- | --------------------------------------- |
| í”„ë¡œì íŠ¸ ë£¨íŠ¸ | `~/gazehome/`                           |
| Backend ì½”ë“œ  | `~/gazehome/edge-module/backend/`       |
| Frontend ì½”ë“œ | `~/gazehome/edge-module/frontend/`      |
| ë¹Œë“œ ê²°ê³¼     | `~/gazehome/edge-module/frontend/dist/` |
| Nginx ë°°í¬    | `/var/www/html/`                        |
| ë³´ì • ë°ì´í„°   | `~/.gazehome/calibrations/`             |
| ì„œë¹„ìŠ¤ ë¡œê·¸   | `journalctl -u <service-name>`          |

### ì„±ëŠ¥ ìµœì í™” íŒ

1. **ë¼ì¦ˆë² ë¦¬íŒŒì´ 4 ê¶Œì¥**: 8GB RAM ëª¨ë¸ ê¶Œì¥
2. **SSD ì‚¬ìš©**: microSD ëŒ€ì‹  USB SSD ì‚¬ìš© ì‹œ ì„±ëŠ¥ í–¥ìƒ
3. **ì˜¤ë²„í´ëŸ­**: í•„ìš” ì‹œ `/boot/config.txt`ì—ì„œ ì„¤ì •
4. **ìŠ¤ì™‘ ë©”ëª¨ë¦¬**: ë¶€ì¡± ì‹œ ìŠ¤ì™‘ í¬ê¸° ì¦ê°€

```bash
# ìŠ¤ì™‘ í¬ê¸° í™•ì¸
free -h

# ìŠ¤ì™‘ í¬ê¸° ì¦ê°€ (2GB)
sudo dphys-swapfile swapoff
sudo nano /etc/dphys-swapfile
# CONF_SWAPSIZE=2048
sudo dphys-swapfile setup
sudo dphys-swapfile swapon
```

---

## ì°¸ê³  ìë£Œ

- **Edge-Module GitHub**: https://github.com/ESWC-AIRIS/edge-module
- **Gateway GitHub**: https://github.com/ESWC-AIRIS/gateway
- **uv ê³µì‹ ë¬¸ì„œ**: https://docs.astral.sh/uv/
- **FastAPI ê³µì‹ ë¬¸ì„œ**: https://fastapi.tiangolo.com/
- **Vite ê³µì‹ ë¬¸ì„œ**: https://vitejs.dev/
- **Nginx ê³µì‹ ë¬¸ì„œ**: https://nginx.org/en/docs/

---

## ë¼ì´ì„ ìŠ¤

MIT License - ìì„¸í•œ ë‚´ìš©ì€ [LICENSE](LICENSE) íŒŒì¼ ì°¸ì¡°

---

## ë¬¸ì˜

- **ì´ìŠˆ ë¦¬í¬íŠ¸**: https://github.com/ESWC-AIRIS/edge-module/issues
- **ê°œë°œíŒ€**: ESWC-AIRIS

---

**ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸**: 2025ë…„ 1ì›” 29ì¼  
**ë²„ì „**: 1.0.0  
**í…ŒìŠ¤íŠ¸ í™˜ê²½**: Raspberry Pi 4 (8GB) + 7" Display
