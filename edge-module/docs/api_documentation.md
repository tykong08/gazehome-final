# Edge Module ë°±ì—”ë“œ API ë¬¸ì„œ

## ğŸ“‹ ëª©ì°¨
1. [REST API ì—”ë“œí¬ì¸íŠ¸](#rest-api-ì—”ë“œí¬ì¸íŠ¸)
2. [WebSocket ì—”ë“œí¬ì¸íŠ¸](#websocket-ì—”ë“œí¬ì¸íŠ¸)
3. [ë°ì´í„° ëª¨ë¸](#ë°ì´í„°-ëª¨ë¸)
4. [AI ì„œë²„ ì—°ë™ í•„ìˆ˜ API](#ai-ì„œë²„-ì—°ë™-í•„ìˆ˜-api)

---

## REST API ì—”ë“œí¬ì¸íŠ¸

### 1. **ê¸°ê¸° ì œì–´**

#### `POST /api/devices/{device_id}/control`
ê¸°ê¸°ë¥¼ ì œì–´í•©ë‹ˆë‹¤ (ON/OFF í† ê¸€, ì„¤ì • ë³€ê²½ ë“±).

**ìš”ì²­:**
```json
{
  "action": "toggle",           // "toggle", "turn_on", "turn_off", "set_brightness" ë“±
  "params": {
    "brightness": 50,            // actionì— ë”°ë¼ í•„ìˆ˜ íŒŒë¼ë¯¸í„° ë‹¤ë¦„
    "temperature": 25
  }
}
```

**ì‘ë‹µ (ì„±ê³µ):**
```json
{
  "success": true,
  "device_id": "light_001",
  "state": "on",
  "message": "ê¸°ê¸°ê°€ í† ê¸€ë˜ì—ˆìŠµë‹ˆë‹¤"
}
```

**ì‘ë‹µ (ì‹¤íŒ¨):**
```json
{
  "success": false,
  "error": "device_not_found",
  "message": "í•´ë‹¹ ê¸°ê¸°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤"
}
```

**HTTP ìƒíƒœ ì½”ë“œ:**
- `200 OK`: ì œì–´ ì„±ê³µ
- `404 NOT FOUND`: ê¸°ê¸° ì—†ìŒ
- `400 BAD REQUEST`: ì˜ëª»ëœ ìš”ì²­
- `500 INTERNAL SERVER ERROR`: ì„œë²„ ì˜¤ë¥˜

---

#### `GET /api/devices`
ì—°ê²°ëœ ëª¨ë“  ê¸°ê¸° ëª©ë¡ì„ ì¡°íšŒí•©ë‹ˆë‹¤.

**ìš”ì²­:** ì—†ìŒ

**ì‘ë‹µ:**
```json
{
  "devices": [
    {
      "id": "light_001",
      "name": "ê±°ì‹¤ ì¡°ëª…",
      "type": "light",
      "room": "ê±°ì‹¤",
      "state": "on",
      "metadata": {
        "brightness": 75,
        "color_temp": 3000
      }
    },
    {
      "id": "ac_001",
      "name": "ê±°ì‹¤ ì—ì–´ì»¨",
      "type": "air_conditioner",
      "room": "ê±°ì‹¤",
      "state": "on",
      "metadata": {
        "current_temp": 22.5,
        "target_temp": 25,
        "mode": "cooling"
      }
    }
  ]
}
```

---

#### `GET /api/devices/{device_id}`
íŠ¹ì • ê¸°ê¸°ì˜ ìƒíƒœë¥¼ ì¡°íšŒí•©ë‹ˆë‹¤.

**ìš”ì²­:** ì—†ìŒ

**ì‘ë‹µ:**
```json
{
  "id": "light_001",
  "name": "ê±°ì‹¤ ì¡°ëª…",
  "type": "light",
  "room": "ê±°ì‹¤",
  "state": "on",
  "metadata": {
    "brightness": 75,
    "color_temp": 3000
  }
}
```

---

### 2. **ì‚¬ìš©ì ì„¤ì •**

#### `GET /api/users/me`
í˜„ì¬ ë¡œê·¸ì¸í•œ ì‚¬ìš©ì ì •ë³´ë¥¼ ì¡°íšŒí•©ë‹ˆë‹¤.

**ìš”ì²­:** ì—†ìŒ

**ì‘ë‹µ:**
```json
{
  "user_id": "user_001",
  "username": "taeyoung",
  "email": "user@example.com",
  "preferences": {
    "theme": "dark",
    "language": "ko"
  }
}
```

---

#### `POST /api/users/me/preferences`
ì‚¬ìš©ì ì„¤ì •ì„ ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤.

**ìš”ì²­:**
```json
{
  "theme": "light",
  "language": "en",
  "enable_notifications": true
}
```

**ì‘ë‹µ:**
```json
{
  "success": true,
  "message": "ì„¤ì •ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤"
}
```

---

### 3. **ê¸°ê¸° ìë™í™” (Automation Rules)**

#### `GET /api/automations`
ëª¨ë“  ìë™í™” ê·œì¹™ì„ ì¡°íšŒí•©ë‹ˆë‹¤.

**ì‘ë‹µ:**
```json
{
  "automations": [
    {
      "id": "auto_001",
      "name": "í‡´ê·¼ ì‹œê°„ ì¡°ëª… ìë™ ì¼œê¸°",
      "trigger": {
        "type": "time",
        "time": "18:00"
      },
      "actions": [
        {
          "device_id": "light_001",
          "action": "turn_on",
          "params": { "brightness": 100 }
        }
      ],
      "enabled": true
    }
  ]
}
```

---

#### `POST /api/automations`
ìƒˆë¡œìš´ ìë™í™” ê·œì¹™ì„ ìƒì„±í•©ë‹ˆë‹¤.

**ìš”ì²­:**
```json
{
  "name": "ë°¤ 10ì‹œ ëª¨ë“  ì¡°ëª… ë„ê¸°",
  "trigger": {
    "type": "time",
    "time": "22:00"
  },
  "actions": [
    {
      "device_id": "light_001",
      "action": "turn_off"
    }
  ],
  "enabled": true
}
```

**ì‘ë‹µ:**
```json
{
  "success": true,
  "automation_id": "auto_002",
  "message": "ìë™í™” ê·œì¹™ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤"
}
```

---

#### `DELETE /api/automations/{automation_id}`
ìë™í™” ê·œì¹™ì„ ì‚­ì œí•©ë‹ˆë‹¤.

**ì‘ë‹µ:**
```json
{
  "success": true,
  "message": "ìë™í™” ê·œì¹™ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤"
}
```

---

### 4. **ì‹œì„  ì¶”ì  (Gaze Tracking)**

#### `GET /api/gaze/calibration/status`
í˜„ì¬ ìº˜ë¦¬ë¸Œë ˆì´ì…˜ ìƒíƒœë¥¼ ì¡°íšŒí•©ë‹ˆë‹¤.

**ì‘ë‹µ:**
```json
{
  "is_calibrated": true,
  "calibration_quality": 0.95,
  "last_calibrated": "2025-10-20T10:30:00Z",
  "message": "ìº˜ë¦¬ë¸Œë ˆì´ì…˜ ì™„ë£Œë¨"
}
```

---

#### `POST /api/gaze/calibration/start`
ìƒˆë¡œìš´ ìº˜ë¦¬ë¸Œë ˆì´ì…˜ì„ ì‹œì‘í•©ë‹ˆë‹¤.

**ìš”ì²­:**
```json
{
  "num_points": 9,  // 5ì  ë˜ëŠ” 9ì  ìº˜ë¦¬ë¸Œë ˆì´ì…˜
  "duration": 5     // ê° í¬ì¸íŠ¸ë‹¹ ì‹œê°„ (ì´ˆ)
}
```

**ì‘ë‹µ:**
```json
{
  "success": true,
  "calibration_id": "cal_001",
  "message": "ìº˜ë¦¬ë¸Œë ˆì´ì…˜ì´ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤"
}
```

---

#### `GET /api/gaze/calibration/progress/{calibration_id}`
ìº˜ë¦¬ë¸Œë ˆì´ì…˜ ì§„í–‰ ìƒí™©ì„ ì¡°íšŒí•©ë‹ˆë‹¤.

**ì‘ë‹µ:**
```json
{
  "progress": 60,          // 0-100
  "current_point": 6,
  "total_points": 9,
  "status": "in_progress",
  "message": "6/9 í¬ì¸íŠ¸ ìˆ˜ì§‘ë¨"
}
```

---

### 5. **ê¶Œì¥ì‚¬í•­ (Recommendations)**

#### `GET /api/recommendations`
AI ì„œë²„ì—ì„œ ìƒì„±í•œ ê¶Œì¥ì‚¬í•­ ëª©ë¡ì„ ì¡°íšŒí•©ë‹ˆë‹¤.

**ì‘ë‹µ:**
```json
{
  "recommendations": [
    {
      "id": "rec_001",
      "title": "ê±°ì‹¤ ì¡°ëª…ì„ ì¼œì‹œê² ì–´ìš”?",
      "description": "ë°ê¸°ê°€ ë‚®ì•„ ê¶Œì¥ë“œë¦½ë‹ˆë‹¤",
      "device_id": "light_001",
      "device_name": "ê±°ì‹¤ ì¡°ëª…",
      "action": "turn_on",
      "params": { "brightness": 80 },
      "priority": 3,              // 1-5 (5=ê¸´ê¸‰)
      "reason": "ì‚¬ìš©ì í–‰ë™ íŒ¨í„´ ë¶„ì„",
      "timestamp": "2025-10-20T10:45:00Z"
    }
  ],
  "total": 1
}
```

---

#### `POST /api/recommendations/{recommendation_id}/feedback`
ê¶Œì¥ì‚¬í•­ì— ëŒ€í•œ ì‚¬ìš©ì í”¼ë“œë°±ì„ ì „ì†¡í•©ë‹ˆë‹¤.

**ìš”ì²­:**
```json
{
  "action": "accepted",  // "accepted", "rejected", "postponed"
  "reason": "ì‚¬ìš©ìê°€ ìˆ˜ë½í•¨"
}
```

**ì‘ë‹µ:**
```json
{
  "success": true,
  "message": "í”¼ë“œë°±ì´ ê¸°ë¡ë˜ì—ˆìŠµë‹ˆë‹¤"
}
```

---

## WebSocket ì—”ë“œí¬ì¸íŠ¸

### 1. **ì‹œì„  ìŠ¤íŠ¸ë¦¼ `/ws/gaze`**

**ëª©ì :** ì‹¤ì‹œê°„ ì‹œì„  ìœ„ì¹˜ ë° ëˆˆ ìƒíƒœ ìŠ¤íŠ¸ë¦¬ë° (30-60 FPS)

**ì—°ê²°:**
```javascript
const ws = new WebSocket('ws://localhost:8000/ws/gaze')
```

**ìˆ˜ì‹  ë©”ì‹œì§€ (ì„œë²„ â†’ í´ë¼ì´ì–¸íŠ¸):**

#### 1-1) ìº˜ë¦¬ë¸Œë ˆì´ì…˜ ìƒíƒœ (ì—°ê²° ì‹œ)
```json
{
  "type": "calibration_status",
  "calibrated": true,
  "message": "ì‹œì„  ì¶”ì ê¸°ì— ì—°ê²°ë¨"
}
```

#### 1-2) ì‹œì„  ë°ì´í„° (ì§€ì†ì )
```json
{
  "type": "gaze_update",
  "timestamp": 1697779500.123,
  "gaze": [960, 540],              // í™”ë©´ìƒ ì‹œì„  ìœ„ì¹˜ (x, y)
  "raw_gaze": [950, 535],          // í•„í„°ë§ ì „ ì›ë³¸ ì‹œì„  ìœ„ì¹˜
  "blink": false,                  // ğŸ‘ï¸ í˜„ì¬ ëˆˆê¹œë¹¡ì„ ìƒíƒœ
  "prolonged_blink": false,        // ğŸ‘ï¸ 1ì´ˆ ì´ìƒ ëˆˆê¹œë¹¡ì„ (í´ë¦­ ì¸ì‹)
  "calibrated": true               // ğŸ” ì‹œì„  ì¸ì‹ ê°€ëŠ¥ ì—¬ë¶€
}
```

**ë°ì´í„° í•„ë“œ ì„¤ëª…:**
| í•„ë“œ              | íƒ€ì…         | ì„¤ëª…                                                       |
| ----------------- | ------------ | ---------------------------------------------------------- |
| `gaze`            | `[int, int]` | í•„í„°ë§ëœ ì‹œì„  ìœ„ì¹˜ (í”½ì…€)                                  |
| `raw_gaze`        | `[int, int]` | í•„í„°ë§ ì „ ì›ë³¸ ì‹œì„  ìœ„ì¹˜                                   |
| `blink`           | `bool`       | `true` = ëˆˆì„ ê°ì€ ìƒíƒœ (í¬ì¸í„° ê³ ì •)                      |
| `prolonged_blink` | `bool`       | `true` = 1ì´ˆ ì´ìƒ ëˆˆì„ ê°ì€ ìƒíƒœ (í´ë¦­)                    |
| `calibrated`      | `bool`       | `true` = ì‹œì„  ì¸ì‹ ê°€ëŠ¥, `false` = ì¸ì‹ ë¶ˆê°€ (í¬ì¸í„° ê³ ì •) |

**í”„ë¡ íŠ¸ì—”ë“œ ì²˜ë¦¬ ì˜ˆì‹œ:**
```javascript
ws.onmessage = (event) => {
  const data = JSON.parse(event.data)
  
  if (data.type === 'gaze_update') {
    // í¬ì¸í„° ìœ„ì¹˜ ì—…ë°ì´íŠ¸
    updateGazeCursor(data.gaze)
    
    // ëˆˆê¹œë¹¡ì„ ê°ì§€ â†’ í´ë¦­
    if (data.prolonged_blink) {
      handleClick()
    }
    
    // ì‹œì„  ì¸ì‹ ë¶ˆê°€ â†’ í¬ì¸í„° ê³ ì •
    if (!data.calibrated) {
      freezePointer()
    }
    
    // ëˆˆê¹œë¹¡ì„ â†’ í¬ì¸í„° ê³ ì •
    if (data.blink) {
      freezePointer()
    }
  }
}
```

---

### 2. **ì œì–´ ëª…ë ¹ `/ws/control`**

**ëª©ì :** ìº˜ë¦¬ë¸Œë ˆì´ì…˜, ì„¤ì • ë³€ê²½ ë“±ì˜ ì œì–´ ëª…ë ¹ ìˆ˜ì‹ 

**ì—°ê²°:**
```javascript
const ws = new WebSocket('ws://localhost:8000/ws/control')
```

**ì†¡ì‹  ë©”ì‹œì§€ (í´ë¼ì´ì–¸íŠ¸ â†’ ì„œë²„):**

#### 2-1) ìº˜ë¦¬ë¸Œë ˆì´ì…˜ ì‹œì‘
```json
{
  "command": "start_calibration",
  "params": {
    "num_points": 9
  }
}
```

**ì‘ë‹µ:**
```json
{
  "type": "response",
  "command": "start_calibration",
  "status": "success",
  "message": "ìº˜ë¦¬ë¸Œë ˆì´ì…˜ì´ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤"
}
```

#### 2-2) ìº˜ë¦¬ë¸Œë ˆì´ì…˜ ë¡œë“œ
```json
{
  "command": "load_calibration",
  "file": "/path/to/calibration.pkl"
}
```

**ì‘ë‹µ:**
```json
{
  "type": "response",
  "command": "load_calibration",
  "status": "success",
  "message": "ìº˜ë¦¬ë¸Œë ˆì´ì…˜ ë¡œë“œë¨: /path/to/calibration.pkl"
}
```

#### 2-3) ìº˜ë¦¬ë¸Œë ˆì´ì…˜ ì €ì¥
```json
{
  "command": "save_calibration",
  "file": "/path/to/calibration.pkl"
}
```

**ì‘ë‹µ:**
```json
{
  "type": "response",
  "command": "save_calibration",
  "status": "success",
  "message": "ìº˜ë¦¬ë¸Œë ˆì´ì…˜ ì €ì¥ë¨: /path/to/calibration.pkl"
}
```

---

### 3. **ìº˜ë¦¬ë¸Œë ˆì´ì…˜ íŠ¹ì§• ìŠ¤íŠ¸ë¦¼ `/ws/features`**

**ëª©ì :** ìº˜ë¦¬ë¸Œë ˆì´ì…˜ ì¤‘ ì‹¤ì‹œê°„ ì–¼êµ´ íŠ¹ì§• ë° ê°ì§€ ìƒíƒœ ìŠ¤íŠ¸ë¦¬ë°

**ì—°ê²°:**
```javascript
const ws = new WebSocket('ws://localhost:8000/ws/features')
```

**ìˆ˜ì‹  ë©”ì‹œì§€ (ì„œë²„ â†’ í´ë¼ì´ì–¸íŠ¸):**

```json
{
  "type": "features",
  "timestamp": 1697779500.123,
  "has_face": true,                  // ì–¼êµ´ ê°ì§€ ì—¬ë¶€
  "blink": false,                    // ëˆˆê¹œë¹¡ì„ ê°ì§€
  "features": [0.1, 0.2, 0.3, ...]   // ì›ë³¸ íŠ¹ì§• ë²¡í„° (128ì°¨ì›)
}
```

**ìš©ë„:** ìº˜ë¦¬ë¸Œë ˆì´ì…˜ í˜ì´ì§€ì—ì„œ ì‹¤ì‹œê°„ ì–¼êµ´ ê°ì§€ ìƒíƒœ í‘œì‹œ

---

## ë°ì´í„° ëª¨ë¸

### Device (ê¸°ê¸°)
```json
{
  "id": "light_001",
  "name": "ê±°ì‹¤ ì¡°ëª…",
  "type": "light",
  "room": "ê±°ì‹¤",
  "state": "on",
  "metadata": {
    "brightness": 75,
    "color_temp": 3000,
    "power_consumption": 15
  }
}
```

**ê¸°ê¸° íƒ€ì…:**
- `light`: ì¡°ëª…
- `air_conditioner`: ì—ì–´ì»¨
- `air_purifier`: ê³µê¸°ì²­ì •ê¸°
- `thermostat`: ì˜¨ë„ ì¡°ì ˆê¸°
- `plug`: ìŠ¤ë§ˆíŠ¸ í”ŒëŸ¬ê·¸

---

### Recommendation (ê¶Œì¥ì‚¬í•­)
```json
{
  "id": "rec_001",
  "title": "ê±°ì‹¤ ì¡°ëª…ì„ ì¼œì‹œê² ì–´ìš”?",
  "description": "ë°ê¸°ê°€ ë‚®ì•„ ê¶Œì¥ë“œë¦½ë‹ˆë‹¤",
  "device_id": "light_001",
  "device_name": "ê±°ì‹¤ ì¡°ëª…",
  "action": "turn_on",
  "params": {},
  "priority": 3,
  "reason": "ì‚¬ìš©ì í–‰ë™ íŒ¨í„´ ë¶„ì„",
  "timestamp": "2025-10-20T10:45:00Z"
}
```

**ìš°ì„ ìˆœìœ„ (Priority):**
| ê°’  | ì´ë¦„        | ì„¤ëª…           |
| --- | ----------- | -------------- |
| 5   | ê¸´ê¸‰ (ë¹¨ê°•) | ì¦‰ì‹œ ì¡°ì¹˜ í•„ìš” |
| 4   | ë†’ìŒ (ì£¼í™©) | ë¹ ë¥¸ ì¡°ì¹˜ ê¶Œì¥ |
| 3   | ë³´í†µ (íŒŒë‘) | ì¼ë°˜ ê¶Œì¥ì‚¬í•­  |
| 2   | ë‚®ìŒ (ì´ˆë¡) | ì„ íƒì‚¬í•­       |
| 1   | ì°¸ê³  (íšŒìƒ‰) | ì •ë³´ì„±         |

---

### Automation (ìë™í™” ê·œì¹™)
```json
{
  "id": "auto_001",
  "name": "í‡´ê·¼ ì‹œê°„ ì¡°ëª… ìë™ ì¼œê¸°",
  "trigger": {
    "type": "time",
    "time": "18:00"
  },
  "actions": [
    {
      "device_id": "light_001",
      "action": "turn_on",
      "params": { "brightness": 100 }
    }
  ],
  "enabled": true
}
```

**íŠ¸ë¦¬ê±° íƒ€ì…:**
- `time`: íŠ¹ì • ì‹œê°„ì— ì‹¤í–‰
- `device_state`: íŠ¹ì • ê¸°ê¸° ìƒíƒœ ë³€í™”
- `gaze`: ì‹œì„  ì¸ì‹ ì´ë²¤íŠ¸

---

## AI ì„œë²„ ì—°ë™ í•„ìˆ˜ API

### ğŸ“Œ AI ì„œë²„ì™€ì˜ ì—°ë™ ì‹œ í•„ìˆ˜ì ìœ¼ë¡œ ì‚¬ìš©ë˜ëŠ” API

#### 1. **ê¶Œì¥ì‚¬í•­ ìˆ˜ì‹ **
```
GET /api/recommendations
```
- **ë¹ˆë„:** 5-10ë¶„ë§ˆë‹¤ ì£¼ê¸°ì ìœ¼ë¡œ í˜¸ì¶œ
- **ìš©ë„:** AI ì„œë²„ì—ì„œ ìƒì„±í•œ ìµœì‹  ê¶Œì¥ì‚¬í•­ ì¡°íšŒ
- **ì‘ë‹µ:** ìš°ì„ ìˆœìœ„ ê¸°ë°˜ ê¶Œì¥ì‚¬í•­ ë¦¬ìŠ¤íŠ¸

#### 2. **ê¸°ê¸° ìƒíƒœ ì¡°íšŒ**
```
GET /api/devices
```
- **ë¹ˆë„:** ê¶Œì¥ì‚¬í•­ ìƒì„± ì „ í˜¸ì¶œ (AI ì„œë²„ ìš”ì²­ ì‹œ)
- **ìš©ë„:** í˜„ì¬ ëª¨ë“  ê¸°ê¸° ìƒíƒœë¥¼ AI ì„œë²„ì— ì „ë‹¬
- **ì‘ë‹µ:** ì‹¤ì‹œê°„ ê¸°ê¸° ìƒíƒœ ë° ë©”íƒ€ë°ì´í„°

#### 3. **ê¸°ê¸° ì œì–´**
```
POST /api/devices/{device_id}/control
```
- **ë¹ˆë„:** ê¶Œì¥ì‚¬í•­ ìˆ˜ë½ ì‹œ í˜¸ì¶œ
- **ìš©ë„:** AIê°€ ì¶”ì²œí•œ ë™ì‘ì„ ì‹¤ì œ ê¸°ê¸°ì— ì ìš©
- **ì‘ë‹µ:** ì œì–´ ì„±ê³µ/ì‹¤íŒ¨ ì—¬ë¶€

#### 4. **í”¼ë“œë°± ì „ì†¡**
```
POST /api/recommendations/{recommendation_id}/feedback
```
- **ë¹ˆë„:** ê¶Œì¥ì‚¬í•­ë§ˆë‹¤ í•œ ë²ˆ (ìˆ˜ë½/ê±°ì ˆ ì‹œ)
- **ìš©ë„:** AI ì„œë²„ì˜ í•™ìŠµ ë°ì´í„°ë¡œ í™œìš©
- **ì‘ë‹µ:** í”¼ë“œë°± ê¸°ë¡ ì™„ë£Œ

#### 5. **ì‹œì„  ë°ì´í„° ìŠ¤íŠ¸ë¦¬ë°**
```
WebSocket: /ws/gaze
```
- **ë¹ˆë„:** ì§€ì†ì  (30-60 FPS)
- **ìš©ë„:** 
  - ì‹œì„  ê¸°ë°˜ UI ìƒí˜¸ì‘ìš© ê°ì§€
  - ì‚¬ìš©ìì˜ ì£¼ì˜ íŒ¨í„´ ë¶„ì„
  - ëˆˆê¹œë¹¡ì„ í´ë¦­ ì¸ì‹
- **ì‘ë‹µ:** ì‹¤ì‹œê°„ ì‹œì„  ìœ„ì¹˜ ë° ëˆˆ ìƒíƒœ

---

### ğŸ”„ AI ì„œë²„ ì—°ë™ í”Œë¡œìš°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. ê¸°ê¸° ìƒíƒœ ì¡°íšŒ                                       â”‚
â”‚    GET /api/devices â†’ AI ì„œë²„ë¡œ ì „ë‹¬                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. ê¶Œì¥ì‚¬í•­ ìˆ˜ì‹                                         â”‚
â”‚    AI ì„œë²„ê°€ ë¶„ì„ í›„ ê¶Œì¥ì‚¬í•­ ìƒì„±                      â”‚
â”‚    GET /api/recommendations â†’ í”„ë¡ íŠ¸ì—”ë“œì— í‘œì‹œ        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. ì‚¬ìš©ì ì„ íƒ                                          â”‚
â”‚    - ìˆ˜ë½: ê¸°ê¸° ì œì–´ ì‹¤í–‰                               â”‚
â”‚    - ê±°ì ˆ: í”¼ë“œë°±ë§Œ ì „ì†¡                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. ê¸°ê¸° ì œì–´                                            â”‚
â”‚    POST /api/devices/{device_id}/control                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. í”¼ë“œë°± ì „ì†¡                                          â”‚
â”‚    POST /api/recommendations/{id}/feedback              â”‚
â”‚    â†’ AI ì„œë²„ì˜ í•™ìŠµ ë°ì´í„°ë¡œ í™œìš©                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### ë°ì´í„° ì „ë‹¬ ì˜ˆì‹œ

**Step 1: ê¸°ê¸° ìƒíƒœ ì¡°íšŒ**
```python
# í”„ë¡ íŠ¸ì—”ë“œ â†’ ë°±ì—”ë“œ
GET /api/devices

# ì‘ë‹µ (ë°±ì—”ë“œ â†’ AI ì„œë²„ë¡œ ì „ë‹¬)
{
  "devices": [
    {"id": "light_001", "state": "off", "brightness": 0},
    {"id": "ac_001", "state": "on", "temp": 22}
  ]
}
```

**Step 2: AI ì„œë²„ì—ì„œ ê¶Œì¥ì‚¬í•­ ìƒì„±**
```python
# AI ì„œë²„ ë¶„ì„ ë¡œì§
# - ì‹œê°: 18:00 (í‡´ê·¼ ì‹œê°„)
# - í˜„ì¬ ìƒíƒœ: ì¡°ëª… OFF
# - íŒ¨í„´: í‡´ê·¼ ì‹œê°„ì— ì¡°ëª… ì¼œëŠ” ìŠµê´€
# â†’ ê¶Œì¥: ê±°ì‹¤ ì¡°ëª… ì¼œê¸° (ìš°ì„ ìˆœìœ„ 3)
```

**Step 3: ê¶Œì¥ì‚¬í•­ ì¡°íšŒ**
```python
GET /api/recommendations

{
  "recommendations": [
    {
      "id": "rec_001",
      "title": "ê±°ì‹¤ ì¡°ëª…ì„ ì¼œì‹œê² ì–´ìš”?",
      "device_id": "light_001",
      "action": "turn_on",
      "priority": 3
    }
  ]
}
```

**Step 4: ì‚¬ìš©ìê°€ ìˆ˜ë½**
```python
# ê¸°ê¸° ì œì–´
POST /api/devices/light_001/control
{
  "action": "turn_on",
  "params": {"brightness": 100}
}
```

**Step 5: í”¼ë“œë°± ì „ì†¡**
```python
POST /api/recommendations/rec_001/feedback
{
  "action": "accepted",
  "reason": "ì‚¬ìš©ìê°€ ê¶Œì¥ì‚¬í•­ì„ ìˆ˜ë½í•¨"
}
# AI ì„œë²„ëŠ” ì´ í”¼ë“œë°±ì„ í•™ìŠµ ë°ì´í„°ë¡œ í™œìš©
```

---

## ğŸ”§ ê°œë°œ íŒ

### ì—ëŸ¬ ì²˜ë¦¬
```javascript
try {
  const response = await fetch('/api/devices')
  if (!response.ok) {
    console.error(`HTTP ${response.status}: ${response.statusText}`)
  }
  const data = await response.json()
} catch (error) {
  console.error('API í˜¸ì¶œ ì‹¤íŒ¨:', error)
}
```

### WebSocket ì¬ì—°ê²°
```javascript
const connectWebSocket = () => {
  const ws = new WebSocket('ws://localhost:8000/ws/gaze')
  
  ws.onclose = () => {
    // 3ì´ˆ í›„ ì¬ì—°ê²°
    setTimeout(connectWebSocket, 3000)
  }
}
```

### íƒ€ì„ì•„ì›ƒ ì²˜ë¦¬
```javascript
const fetchWithTimeout = (url, timeout = 5000) => {
  return Promise.race([
    fetch(url),
    new Promise((_, reject) =>
      setTimeout(() => reject(new Error('Timeout')), timeout)
    )
  ])
}
```

---

## ğŸ“ ë¬¸ì˜

ë°±ì—”ë“œ ê´€ë¦¬ì: [ì—¬ê¸°ì— ì—°ë½ì²˜ ì¶”ê°€]

